<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="Member">

	<!-- 쿼리를 xml로 작성하고 id:식별값  
		  parameterType:우리가 전달할값 
	     resultType : 받아오는값  -->
	     
	<!-- if test="key=='1'"  - 이렇게 쓰면 안된다 인식안된다 -->
	
	<select id="Member_getList"  parameterType="MemberDto"  resultType="MemberDto">
 		select
			A.user_id
			,A.user_password
			,A.user_name 
			,A.user_nick
			,A.user_birth
			,A.user_email
			,A.user_phone
			,A.user_wdate
		from member A

	</select>

	
	<select id="Member_getTotal" parameterType="MemberDto" resultType="Integer">
		select count(*) from Member
		<if test='key!=null and keyword!=null'>

			<if test='key=="1"'>
			where title like concat('%', #{keyword} , '%') or
			      contents like concat('%', #{keyword} , '%') or 
			      writer like concat('%', #{keyword} , '%') 
			</if>
			
			<if test='key=="2"'>
			where title like concat('%', #{keyword} , '%')
			</if>
			
			<if test='key=="3"'>
			where contents like concat('%', #{keyword} , '%')
			</if>
			
			<if test='key=="4"'>
			where title like concat('%', #{keyword} , '%') or
			      contents like concat('%', #{keyword} , '%') 
			</if>
			
		</if> 
	</select>

	
	<insert id="Member_insert" parameterType="MemberDto">
		insert into Member
		( user_id, user_password, user_name, user_nick, user_birth, user_email,user_phone,user_wdate)
		values
		(#{user_id}, #{user_password},#{user_name},#{user_nick},#{user_birth},#{user_email},#{user_phone},now() )
	</insert>
	
	<select id="Member_getView"  parameterType="MemberDto"  resultType="MemberDto">
 		
 		select
 				 A.user_id
				,A.user_password 
				,A.user_name
				,A.user_nick
				,A.user_birth
				,A.user_email
				,A.user_phone
				,A.user_wdate
			
		from member A where dday_seq=#{dday_seq}
		

	</select>
	
	<delete id="Member_delete" parameterType="MemberDto" >
	delete from Member where user_key=#{user_key}
	</delete>
	
	<insert id="Member_update" parameterType="MemberDto">
	update Member set 
		user_password = #{user_password},
		user_name = #{user_name},
		user_nick = #{user_nick},
		user_birth = #{user_birth},
		user_email = #{user_email},
		user_phone = #{user_phone}
			
		where user_id=#{user_id}
	</insert>

		
</mapper>















